<html>
<head>
  <title> Problem 3 </title>
  <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>
  <body>
    <h3> Registration Form </h3>
    <form id = "regForm" action="" method = "POST">
      <table border = "0">
        <tr>
          <td> Customer or Employee: </td>
          <td>
            <select name = "dropdown">
              <option selected = "selected"> Customer </option>
              <option> Employee </option>
            </select>
          </td>
        </tr>
        <tr>
          <td> First Name: </td>
          <td><input name = "fName" type = "text" size = "30"  /></td>
        </tr>
        <tr>
          <td> Last Name: </td>
          <td><input name = "lName" type = "text" size = "30"  /></td>
        </tr>
        <tr>
          <td> Email Address: </td>
          <td><input name = "email" type = "email" size = "30"  /></td>
        </tr>
        <tr>
          <td> Customer Number / Social Security: </td>
          <td><input name = "identification" type = "text" size = "30"  /></td>
        </tr>
        <tr>
          <td><button type = "button" onClick = "validate()">Register</button></td>
          <td><input type = "reset" value = "Clear" /></td>
        </tr>
      </table>
    </form>
</body>
<script type="text/javascript">
  var person = function() {
  	var data = {
      firstName: "",
      $firstName: function(n){data.firstName = n;},
  	  lastName: "",
  	  $lastName: function(n){data.lastName = n;},
  	  emailAddress: "",
  	  $emailAddress: function(n){data.emailAddress = n;},
  	  iden: "",
  	  $id: function(n){data.iden = n;}
  	};

  	var F = function(){};
  	f = new F();

  	f.run = function(e) {
  		return data[e];
  	};

  	return f;
  }();

  var employee = function(p) {
  	var data = {
      firstName: "",
      $firstName: function(n){data.firstName = n;},
  	  lastName: "",
  	  $lastName: function(n){data.lastName = n;},
  	  emailAddress: "",
  	  $emailAddress: function(n){data.emailAddress = n;},
  	  social: "",
  	  $social: function(n){data.social = n;},
  	  idType: "Social Security"
  	};

  	var F = function(){};
  	F.prototype = p;
  	//p.run("id")(data[social]);
  	f = new F();

  	f.run = function (e) {
  		var r = data[e];
  		if(r === undefined) return F.prototype.run(e);
  		else return r;
  	};

  	return f;

  }(person);

  var customer = function(p) {
  	var data = {
      firstName: "",
      $firstName: function(n){data.firstName = n;},
  	  lastName: "",
  	  $lastName: function(n){data.lastName = n;},
  	  emailAddress: "",
  	  $emailAddress: function(n){data.emailAddress = n;},
  	  customerNumber: 0,
  	  $customerNumber: function(n){data.customerNumber = n;},
  	  idType: "Customer Number"
  	};

  	var F = function(){};
  	F.prototype = p;
  	//p.run("id")(data[customerNumber]);
  	f = new F();

  	f.run = function (e) {
  		var r = data[e];
  		if(r === undefined) return F.prototype.run(e);
  		else return r;
  	};

  	return f;

  }(person);

  function validate() {
  	var elt = document.getElementById("regForm");
  	var person = elt.dropdown[elt.dropdown.selectedIndex].text;
  	
    if (person == "Employee") {
      var p1 = Object.create(employee);
      p1.run("$social")(elt.identification.value);
    } else if (person == "Customer") {
      var p1 = Object.create(customer);
      p1.run("$customerNumber")(elt.identification.value);
    } else {
      alert("there is a code error");
    }

    p1.run("$firstName")(elt.fName.value);
    p1.run("$lastName")(elt.lName.value);
    p1.run("$emailAddress")(elt.email.value);

    if (person == "Customer") {
      alert("Name: " + p1.run("firstName") + ' ' + p1.run("lastName") + '\nEmail: ' + p1.run("emailAddress") + "\n" + p1.run('idType') + ": " + p1.run("customerNumber") + "\nIs Registered!");
    } else if (person == "Employee") {
      alert("Name: " + p1.run("firstName") + ' ' + p1.run("lastName") + '\nEmail: ' + p1.run("emailAddress") + "\n" + p1.run('idType') + ": " + p1.run("social") + "\nIs Registered!");
    } else {
      alert("there is a code error");
    }
  }
</script>
</html>